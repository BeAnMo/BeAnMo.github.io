<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SSH for Github</title><link href="https://fonts.googleapis.com/css2?family=Merriweather&family=Montserrat:wght@500&family=Source+Code+Pro&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"><style>body{margin:0;padding:0;font-size:1.1rem;font-weight:500;font-family:Merriweather,serif;background-color:#fbfbfb;color:#444}h1,h2,h3,h4,h5,h6{font-family:Montserrat,-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;margin:1rem 0}p{margin:1rem 0}pre{background-color:#eee;padding:.5rem;width:100%;overflow:auto;line-height:1rem}code{font-family:Source Code Pro,monospace;color:#00a19c}a{color:#0083c1}a:hover{color:#00a19c}a:active{color:#f98e2c}a:visited{color:#ce112d}</style><link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="/assets/css/prism-theme.css"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-178156821-2"></script><script>window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-178156821-2');</script></head><body><nav class="navbar"><h3><a href="/#about-me">Benjamin Morin</a></h3><div class="navbar-links"></div></nav><main class="container"><article class="content"><header><h1 style="margin-bottom: 0;">SSH for Github</h1><h5 style="margin-top: 0;" class="lt-text">Fri Oct 02 2020</h5></header><section><div class="post-body"><p>One of the hassles with <a href="https://git-scm.com/" target="_blank" rel="noopener"><code>git</code></a> in the terminal is authorization/authentication for various commands: <code>git pull/push/commit...</code>. Luckily, by using SSH instead of HTTPS bypasses the need to enter a user/password for any auth'ed action.</p><p>Setting up SSH for a git repo is simple enough:</p><ol><li>Find out what remote urls are being used (also usable for bitbucket.org):<pre class="language-shell"><code class="language-shell">$ <span class="token function">git</span> remote -v<br><span class="token operator">></span> origin https://github.com/<span class="token environment constant">USER</span>/REPO.git <span class="token punctuation">(</span>fetch<span class="token punctuation">)</span><br><span class="token operator">></span> origin https://github.com/<span class="token environment constant">USER</span>/REPO.git <span class="token punctuation">(</span>push<span class="token punctuation">)</span></code></pre></li><li>Set the remote for SSH:<pre class="language-shell"><code class="language-shell">$ <span class="token function">git</span> remote set-url origin git@github.com:<span class="token environment constant">USER</span>/REPO.git<br><span class="token comment"># Verify new remote URL</span><br><span class="token operator">></span> origin origin git@github.com:<span class="token environment constant">USER</span>/REPO.git <span class="token punctuation">(</span>fetch<span class="token punctuation">)</span><br><span class="token operator">></span> origin origin git@github.com:<span class="token environment constant">USER</span>/REPO.git <span class="token punctuation">(</span>push<span class="token punctuation">)</span></code></pre></li><li>Verify endpoints were updated by rerunning <code>git remote -v</code>.</li></ol><p>Now that git has been set up to use SSH, there needs to be an ssh key.</p><ol><li>Run the key generator for an <a href="https://simple.wikipedia.org/wiki/RSA_algorithm" target="_blank" rel="noopener">RSA</a> encrypted algorithm (by default the private/public key pair will be save in /home/USER/.ssh):<pre class="language-shell"><code class="language-shell">$ ssh-keygen -t rsa</code></pre></li><li>Copy the contents of the new <code>.pub</code> file (the public key).</li><li>Go the profile page at github.com and go to <em>Settings</em> -&gt; <em>SSH and GPG Keys</em>.</li><li>Click <em>New SSH Key</em>, paste the contents into <strong>Key</strong> and give it a title.</li></ol><p>Even though github has the public key and is using the SSH remote URL, it's still not enough to use SSH quite yet.</p><ol><li>Check to see if <code>ssh-agent</code> is a running process using <a href="https://man7.org/linux/man-pages/man1/ps.1.html" target="_blank" rel="noopener"><code>ps</code></a> and <a href="https://man7.org/linux/man-pages/man1/grep.1.html" target="_blank" rel="noopener"><code>grep</code></a>:<pre class="language-shell"><code class="language-shell">$ <span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"ssh-agent"</span></code></pre></li><li>The new private key needs to be added to <code>ssh-agent</code>:<ul><li>If no current <code>ssh-agent</code> exists, start it (calling <code>eval</code> captures any shell environment variables):<pre class="language-shell"><code class="language-shell">$ <span class="token builtin class-name">eval</span> <span class="token variable"><span class="token variable">`</span>ssh-agent -s<span class="token variable">`</span></span></code></pre></li><li>Otherwise continue by adding the <em>private</em> key to the agent and confirm by listing current keys:<pre class="language-shell"><code class="language-shell">$ ssh-add /home/<span class="token punctuation">[</span><span class="token environment constant">USER</span><span class="token punctuation">]</span>/.ssh/id_rsa<br>$ ssh-add -l</code></pre></li></ul></li></ol><p>Great, now any auth'ed git action will use the new SSH key, eliminating the hassle of using the password.</p><h2>WSL Addendum</h2><p>While using the <a href="https://docs.microsoft.com/en-us/windows/wsl/" title="Windows Subsystem for Linux" target="_blank" rel="noopener">WSL2</a>, each terminal window is treated as a separate login. This means that a new <code>ssh-agent</code> has to be created in order to make use of SSH keys for the <code>git</code> workflow. This makes using multiple terminal windows in <a target="_blank" rel="noopener" href="https://code.visualstudio.com/">Visual Studio Code</a> (or in any other program) a serious annoyance.</p><p>A simple way to deal with this hassle is to use <a href="https://linux.die.net/man/1/keychain" target="_blank" rel="noopener"><code>keychain</code></a>, which allows sharing the <code>ssh-agent</code> between logins.</p><p>With a WSL terminal open (assuming an Ubuntu/Debian distribution):</p><ol><li>Install keychain:<pre class="language-shell"><code class="language-shell">$ <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> keychain</code></pre></li><li>Verify that values exist for the <code>HOME</code> and <code>HOSTNAME</code> environment variables:<pre class="language-shell"><code class="language-shell">$ <span class="token builtin class-name">echo</span> <span class="token variable">$HOST</span><br>$ <span class="token builtin class-name">echo</span> <span class="token environment constant">$HOSTNAME</span></code></pre></li><li>In the home directory (<code>/home/[USER]</code>), open either <code>.bashrc</code> or <code>.bash_profile</code> in a text editor and add the following:<pre class="language-shell"><code class="language-shell">keychain <span class="token environment constant">$HOME</span>/.ssh/id_rsa<br><span class="token builtin class-name">source</span> <span class="token environment constant">$HOME</span>/.keychain/<span class="token environment constant">$HOSTNAME</span>-sh</code></pre></li></ol><p>Now with each shell login will have access to the same <code>ssh-agent</code> and the private key <code>id_rsa</code> is ready to use for any auth'ed git command.</p></div></section></article></main><footer class="container" style="height: 4rem;"><div class="content" style="display: flex; justify-content: flex-end;"><h5>&copy; 2020 Benjamin Morin</h5></div></footer></body></html>