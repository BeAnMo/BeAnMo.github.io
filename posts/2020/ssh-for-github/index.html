<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="https://fonts.googleapis.com/css2?family=Merriweather&family=Montserrat&family=Source+Code+Pro&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"><style>body{margin:0;padding:0;font-family:Montserrat,-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;background-color:#fbfbfb;color:#333}h1,h2,h3,h4,h5,h6{font-family:Merriweather,serif;margin:1rem 0}p{margin:1rem 0}pre{background-color:#eee;padding:1rem}pre>code{color:#333}code{font-family:Source Code Pro;color:#00a19c}a{color:#0083c1}a:hover{color:#00a19c}a:active{color:#f98e2c}a:visited{color:#ce112d}</style><link rel="stylesheet" href="/assets/css/main.css"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-178156821-2"></script><script>window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-178156821-2');</script></head><body><nav class="navbar"><h3><a href="/#about-me">Benjamin Morin</a></h3><div class="navbar-links"></div></nav><main class="container"><article class="content"><header><h3 style="margin-bottom: 0;">SSH for Github</h3><h6 style="margin-top: 0;" class="lt-text">Fri Oct 02 2020</h6></header><section><div class="post-body"><p>One of the hassles with <a href="https://git-scm.com/" target="_blank" rel="noopener"><code>git</code></a> in the terminal is authorization/authentication for various commands: <code>git pull/push/commit...</code>. Luckily, by using SSH instead of HTTPS bypasses the need to enter a user/password for any auth'ed action.</p><p>Setting up SSH for a git repo is simple enough:</p><ol><li>Find out what remote urls are being used (also usable for bitbucket.org):<pre><code>$ git remote -v
&gt; origin https://github.com/USER/REPO.git (fetch)
&gt; origin https://github.com/USER/REPO.git (push)
</code></pre></li><li>Set the remote for SSH:<pre><code>$ git remote set-url origin git@github.com:USER/REPO.git
# Verify new remote URL
&gt; origin origin git@github.com:USER/REPO.git (fetch)
&gt; origin origin git@github.com:USER/REPO.git (push)
</code></pre></li><li>Verify endpoints were updated by rerunning <code>git remote -v</code>.</li></ol><p>Now that git has been set up to use SSH, there needs to be an ssh key.</p><ol><li>Run the key generator for an <a href="https://simple.wikipedia.org/wiki/RSA_algorithm" target="_blank" rel="noopener">RSA</a> encrypted algorithm (by default the private/public key pair will be save in /home/USER/.ssh):<pre><code>$ ssh-keygen -t rsa
</code></pre></li><li>Copy the contents of the new <code>.pub</code> file (the public key).</li><li>Go the profile page at github.com and go to <em>Settings</em> -&gt; <em>SSH and GPG Keys</em>.</li><li>Click <em>New SSH Key</em>, paste the contents into <strong>Key</strong> and give it a title.</li></ol><p>Even though github has the public key and is using the SSH remote URL, it's still not enough to use SSH quite yet.</p><ol><li>Check to see if <code>ssh-agent</code> is a running process using <a href="https://man7.org/linux/man-pages/man1/ps.1.html" target="_blank" rel="noopener"><code>ps</code></a> and <a href="https://man7.org/linux/man-pages/man1/grep.1.html" target="_blank" rel="noopener"><code>grep</code></a>:<pre><code>$ ps aux | grep &quot;ssh-agent&quot;
</code></pre></li><li>The new private key needs to be added to <code>ssh-agent</code>:<ul><li>If no current <code>ssh-agent</code> exists, start it (calling <code>eval</code> captures any shell environment variables):<pre><code>$ eval `ssh-agent -s`
</code></pre></li><li>Otherwise continue by adding the <em>private</em> key to the agent and confirm by listing current keys:<pre><code>$ ssh-add /home/[USER]/.ssh/id_rsa
$ ssh-add -l
</code></pre></li></ul></li></ol><p>Great, now any auth'ed git action will use the new SSH key, eliminating the hassle of using the password.</p><h4>WSL Addendum</h4><p>While using the <a href="https://docs.microsoft.com/en-us/windows/wsl/" title="Windows Subsystem for Linux" target="_blank" rel="noopener">WSL2</a>, each terminal window is treated as a separate login. This means that a new <code>ssh-agent</code> has to be created in order to make use of SSH keys for the <code>git</code> workflow. This makes using multiple terminal windows in <a target="_blank" rel="noopener" href="https://code.visualstudio.com/">Visual Studio Code</a> (or in any other program) a serious annoyance.</p><p>A simple way to deal with this hassle is to use <a href="https://linux.die.net/man/1/keychain" target="_blank" rel="noopener"><code>keychain</code></a>, which allows sharing the <code>ssh-agent</code> between logins.</p><p>With a WSL terminal open (assuming an Ubuntu/Debian distribution):</p><ol><li>Install keychain:<pre><code>$ sudo apt-get install keychain
</code></pre></li><li>Verify that values exist for the <code>HOME</code> and <code>HOSTNAME</code> environment variables:<pre><code>$ echo $HOST
$ echo $HOSTNAME
</code></pre></li><li>In the home directory (<code>/home/[USER]</code>), open either <code>.bashrc</code> or <code>.bash_profile</code> in a text editor and add the following:<pre><code>keychain $HOME/.ssh/id_rsa
source $HOME/.keychain/$HOSTNAME-sh
</code></pre></li></ol><p>Now with each shell login will have access to the same <code>ssh-agent</code> and the private key <code>id_rsa</code> is ready to use for any auth'ed git command.</p></div></section></article></main><footer class="container" style="height: 4rem;"><div class="content" style="display: flex; justify-content: flex-end;"><h5>&copy; 2020 Benjamin Morin</h5></div></footer></body></html>